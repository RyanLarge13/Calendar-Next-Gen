generator client {
provider = "prisma-client-js"
}

datasource db {
provider = "postgresql"
url      = env("DATABASE_URL")
}

model User {
id            String         @id @default(uuid())
avatarUrl     String?
username      String
email         String         @unique
password      String
birthday      DateTime?
createAt      DateTime       @default(now())
notifSub      String[]
notifSubCanceled String[]
importedGoogleEvents Boolean @default(false)
events        Event[]
reminders     Reminder[]
notifications Notification[]
lists         List[]
tasks Task[]
kanbans Kanban[]
friends       Friend[]       @relation(name: "UserToFriends")

@@index([id], name: "userIdIndex")
}

model Friend {
id String   @id @default(uuid())
createdAt DateTime @default(now())
User User     @relation(name: "UserToFriends", fields: [userId], references: [id])
userId String
}

model Event {
id String   @id @unique
kind String?
summary String
description String?
location Json?
date String
attatchments Number @default(0)
reminders Json?
repeats Json?
attachments Attachment[]
color String
start Json
end Json
updated DateTime @updatedAt
created DateTime @default(now())
User User     @relation(fields: [userId], references: [id])
userId String

@@index([id], name: "eventIdIndex")
@@index([userId], name: "userIdRefIndex")
}

model Attachment {
id String      @id @default(uuid())
filename String
mimetype String
content Bytes
Event Event @relation(fields: [eventId], references: [id], onDelete: Cascade)
eventId String
}


model Reminder {
id String @id @unique @default(uuid())
title String
notes String
time String
eventRefId String?
User User   @relation(fields: [userId], references: [id])
userId String
}

model Notification {
id String  @id @unique @default(uuid())
type String
time String
read Boolean @default(false)
readTime String?
notifData Json
reminderRefId String?
User User    @relation(fields: [userId], references: [id])
sentNotification Boolean @default(false)
sentWebPush Boolean @default(false)
userId String
}

model List {
id String @id @unique @default(uuid())
title String
items Json?
color String
User User   @relation(fields: [userId], references: [id])
userId String
updatedAt DateTime @updatedAt
}

model Task {
id String @id @unique @default(uuid())
date String
tasks Json
completed Boolean
completedDate String
User User   @relation(fields: [userId], references: [id])
userId String
}

model Kanban {
id String @id @unique @default(uuid())
title String
color String
boards Board[]
createdAt DateTime @default(now())
User User   @relation(fields: [userId], references: [id])
userId String
}

model Board {
id String @id @unique @default(uuid())
title String
boardItems BoardItems[]
Project Kanban  @relation(fields: [projectId], references: [id])
projectId String
}

model BoardItems {
id String @id @unique @default(uuid())
Board Board @relation(fields: [boardId], references: [id])
boardId String
}